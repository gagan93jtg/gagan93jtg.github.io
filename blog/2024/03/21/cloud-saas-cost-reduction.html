<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Cloud, SaaS Cost Reduction</title>
  <meta name="description" content="Reducing spend on SaaS tools is a continuous effort. At LocoNav, we keep a strict eye on such expenses and spend some time every now and then to make sure we're not paying extra for any service. In..." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <meta property="og:site_name" content="Gagandeep's Blog" />
  <meta property="og:title" content="Cloud, SaaS Cost Reduction"/>
  
  <meta property="og:description" content="Reducing spend on SaaS tools is a continuous effort. At LocoNav, we keep a strict eye on such expenses and spend some time every now and then to make sure we're not paying extra for any service. In..." />
  
  <meta property="og:image" content="https://gagan93.me/blog//assets/images/2024-03-21-cloud-saas-cost-reduction.jpg" />
  <meta property="og:url" content="https://gagan93.me/blog//2024/03/21/cloud-saas-cost-reduction.html" >
  <meta property="og:type" content="blog" />
  <meta property="article:published_time" content="2024-03-21T00:00:00+05:30">

  <link rel="canonical" href="https://gagan93.me/blog//2024/03/21/cloud-saas-cost-reduction.html"/>
  <link rel="shortcut icon" href="/blog//assets/images/favicon.png" type="image/png"/>
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/blog//css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/blog//css/print.css" />

  <!-- Google tag (gtag.js) -->
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZKG2EDMK4C"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-ZKG2EDMK4C');
    </script>
  
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->


  <a href="https://gagan93.me/blog/" class="logo-readium"><span class="logo" style="background-image: url(https://avatars.githubusercontent.com/u/13852061)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="article-image">
          <div class="post-image-image" style="background-image: url(/blog//assets/images/2024-03-21-cloud-saas-cost-reduction.jpg)">
            Article Image
          </div>
          <div class="post-image-image2" style="background-image: url(/blog//assets/images/2024-03-21-cloud-saas-cost-reduction.jpg)">
            Article Image
          </div>
          <div class="post-meta">
            <h1 class="post-title">Cloud, SaaS Cost Reduction</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(https://avatars.githubusercontent.com/u/13852061)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Gagandeep Singh</h4>
              on
              <time datetime="2024-03-21 00:00">21 Mar 2024</time>
            </div>
            <div style="text-align:center">
              <a href="#topofpage" class="topofpage"><i class="fa fa-angle-down"></i></a>
            </div>
          </div>
        </div>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <h2 style="text-align: center;font-size: 0.8em" id="photo-by-ussama-azam-on-unsplash">Photo by <a href="https://unsplash.com/@ussamaazam?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Ussama Azam</a> on <a href="https://unsplash.com/photos/pink-arrow-neon-sign-26h317_UMYM?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></h2>

<h2 id="background">Background</h2>

<p>Reducing spend on SaaS tools is a continuous effort. At LocoNav, we keep a strict eye on such expenses and spend some time every now and then to make sure we’re not paying extra for any service. In the past 1.5 years, we planned and executed a lot of tasks to reduce our spends. This included what we pay to:</p>

<ol>
  <li>
    <p>Cloud platforms,</p>
  </li>
  <li>
    <p>Observability platforms,</p>
  </li>
  <li>
    <p>Collaboration platforms,</p>
  </li>
  <li>
    <p>And other SaaS tool (eg. we use location related services heavily in our products as we’re a <a href="https://loconav.com/">fleet management product</a>).</p>
  </li>
</ol>

<p>This task was taken up by multiple people including myself and we had to figure out our usage of each tool in a way that we can either optimise them or (possibly) replace them. So the thought process was broken into these categories:</p>

<ol>
  <li>
    <p><strong>Unused resources</strong> - Are there unused resources lying that can be freed to save some 💰? This includes unused Github seats, a server that was mistakenly left running, a disk volume that’s lying unattached after terminating a machine, etc.</p>
  </li>
  <li>
    <p><strong>Optimising Data volume</strong> - Are there tools where we could send less data without impacting the usage? For example, you can control how much data is sent to APM tools and save some cost here because general trend still remains (almost) same and they bill you for the amount of data you send.</p>
  </li>
  <li>
    <p><strong>Finding alternative tools</strong> - Are there tools that can be replaced with cheaper or open source (self-hosted) alternatives?</p>
  </li>
  <li>
    <p><strong>Architectural optimisations</strong> - Can we plan short term and long term architectural changes that would help us save cost? We knew a few things that could be architected better. So we prioritised tasks in a way that have high ROI in the short term were picked first while others were parked for the long term.</p>
  </li>
</ol>

<p>The above thought process looks very structured. Frankly, we did not start like this but this is how it eventually turned out to be.</p>

<h2 id="figuring-out-everything">Figuring out everything</h2>

<h3 id="unused-resources">Unused resources</h3>

<ol>
  <li>
    <p><strong>SaaS platforms</strong> - Most of the SaaS applications have pricing based on no. of users. While onboarding new team members is a usual activity and happens sooner or later, but it’s equally important to offboard them once they leave. In small teams, this leak often remains undetected for months. Beyond cost, this could have other risks unless the user logs in through SSO. So make sure to deactivate accounts and free those seats when users leave. It might have a small impact on monthly bills but it is important to have a complete list of apps where you need to deactivate user accounts.</p>
  </li>
  <li>
    <p><strong>Cloud platforms</strong> - It’s hard to accurately understand and justify cloud spends but members of the team should still have an idea on how many databases, virtual machines and other cloud resources they’re using. If you have a single cloud account that multiple teams use, I’d recommend you to <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html">tag the resources</a> used by respective teams. Once done, it becomes easy to discuss and optimise the cost for each team. Beyond this, you could figure out things that are not used or could be combined. For example, we figured out and did all this:</p>

    <ol>
      <li>
        <p><strong>Buckets</strong> - Check unused S3 buckets and deleted them. Modified storage class for a few of them and set intelligent tiering to a few.</p>
      </li>
      <li>
        <p><strong>EC2/EBS</strong> - We moved to EKS for many apps so we deleted <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html">AMIs</a> for those apps, that helped us free up a lot of space used by snapshots. Apart from this - basic optimisation like deleting unused machines that were left mistakenly, checking instance usage and resizing machines were also done.</p>
      </li>
      <li>
        <p><strong>Merging few deployments</strong> - There were a lot of small projects (both internal and customer facing) which used individual databases, caches and machines. We consolidated databases for a lot of internal tools on a single RDS that still didn’t peak to even 50% of CPU after combining. Thankfully all our relational use cases are on Postgres that helped in this consolidation (read about <a href="https://blog.gagan93.me/avoid-redundant-complexity">embracing simplicity</a>). This was planned for some other projects also that were customer facing but very much related to each other and could be combined.
 Note: Don’t overdo this as this has one potential downside - incase you upgrade this RDS in future in a way that it needs a downtime, you’d need to take downtime on all the apps that use this RDS.</p>
      </li>
    </ol>
  </li>
</ol>

<h3 id="optimising-data-volume">Optimising data volume</h3>

<p>Before understanding what we optimised, I’ll share some background on data transfer (ingress and outgress) costs. Data transfer is one of the most trickiest component in a cloud provider’s bill. For many managed resources, you pay for the amount of data transferred through them (apart from the basic cost of running them). <a href="https://aws.amazon.com/elasticloadbalancing/pricing/">AWS load balancer</a> is a perfect example of this where you pay a monthly cost of using it and another cost for the amount of data transferred. Even beyond this, if the data goes out to the public internet (outside AWS) or a <a href="https://aws.amazon.com/about-aws/global-infrastructure/regions_az/">different region</a>, you get charged extra. The data transfer cost is negligible for personal projects / small apps but it becomes a considerable part of your bill if your apps have a lot of data flowing outside the AZ/Region. The point is - how do I know if the data goes out of cloud provider 🤔? The answer is not so simple and it varies from <a href="https://babatrucks.atlassian.net/browse/INTAKE-7424">one provider</a> to <a href="https://azure.microsoft.com/en-in/pricing/details/bandwidth/">another</a>. As a thumb rule, assume you’ll be charged for data if:</p>

<ol>
  <li>
    <p>It goes out of your AZ (availability zone) or region.</p>
  </li>
  <li>
    <p>You connect to a service that runs on another cloud provider (or generally on public internet).</p>
  </li>
</ol>

<p>Coming back to optimising data volume - We use Datadog for Application Performance Monitoring (APM). Some of our large applications send a lot of data to Datadog. If you check their <a href="https://docs.datadoghq.com/account_management/billing/pricing/#apm">APM billing</a>, you’ll realise that they consider <em>amount of spans ingested</em> for charging the user. Because the data can be very large for mid-large applications, they give an <a href="https://docs.datadoghq.com/tracing/guide/ingestion_sampling_use_cases/#reducing-ingestion-for-high-volume-services">option to control</a> how much percentage of data we want to sample. This reduces costs in two ways: data received at the APM layer is lower (hence less bill) and data emitted from our system is also less (hence less transfer charges). Here, the data transfer cost would impact us only if Datadog’s infrastructure is deployed in a different AZ/Region/Cloud provider. As of March 2023, when someone <a href="https://www.linkedin.com/pulse/datadog-outage-multi-cloud-reliability-dylan-ratcliffe/">unofficially investigated</a> Datadog’s outage, he found out that Datadog uses multi-cloud deployment strategy, i.e. they deploy in AWS, Azure and GCP. So you can believe that your data is most probably going out of the cloud provider.</p>

<p>For your apps - If you start with this basic knowledge of ‘how your cloud provider charges for data transfer’, you can optimise a few things on the bill 😀.</p>

<h3 id="finding-alternative-tools">Finding Alternative tools</h3>

<p>This was a medium-hard problem because shifting people to a new tool is hard. Being a team of ~ 100 software engineers, we use a lot of industry standard tools like APM tools, error trackers, server and website monitoring tools, communication tools and what not. We moved from NewRelic to Datadog for APM back in 2021 (due to cost reasons) and I remember the switch was not easy. While both are very good tools and best in industry, we were habitual of using NewRelic for debugging our slowness and outage cases. It took some time to adjust to Datadog’s features and UX and now we find it quite useful to debug such cases (specially the <a href="https://docs.datadoghq.com/monitors/types/watchdog/?tab=apm">Watchdog</a> feature 👌). Still we tried to find alternate platforms for whatever was possible to replace and started using <a href="https://www.getoutline.com/">this tool</a> for documentations.</p>

<p><strong>Can you also do this ? -</strong> It depends on how much your team is flexible in moving to the new tool. It also depends on the pricing model of your current tool. Like if you’ve already committed or paid for next few months or an year, then you could defer the plan to move. But always try to use tools that allow exporting data into common (non-proprietary) formats. For example, although JIRA is a industry standard tool for managing team sprints, there is <a href="https://community.atlassian.com/t5/Jira-Software-questions/How-to-export-Jira-issues-to-CSV/qaq-p/175115">no way to export all the issues</a> as CSV. The best answer on this community post allows to export max 1000 issues at once. Although importing data to JIRA is easy and explained <a href="https://support.atlassian.com/jira-cloud-administration/docs/migrate-from-other-issue-trackers/">here</a> 🤓.</p>

<h3 id="architectural-optimisations">Architectural optimisations</h3>

<p>These optimisations majorly depend on your own project. For medium-large projects that are live in production from years, the teams are already aware of tech debt and architectural debt. Beyond debt, there could be technological advancements that you can leverage. As an example, Redis is a popular in-memory key-value database. The initial version of Redis was released almost 15 years ago. While there have been a lot of changes and features additions even recently, the basic architecture of command processing remains the same - a single threaded command execution thread. Don’t underestimate the speed of Redis after reading <em>single threaded.</em> While Redis works well for applications of all sizes, there have been a lot of choices now, as Paypal open sourced it’s <a href="https://github.com/paypal/junodb">key value store</a>, a team of developers released a new key value database called <a href="https://www.dragonflydb.io/">Dragonfly</a> and Microsoft introduced <a href="https://www.microsoft.com/en-us/research/blog/introducing-garnet-an-open-source-next-generation-faster-cache-store-for-accelerating-applications-and-services/">Garnet</a> this week. Not everyone wants to move their existing systems to new (promising) databases and you should actually never do that, but I was surprised to see a very stable and <a href="https://github.com/sidekiq/sidekiq/commit/250cc1e4dde44e84d9b607a2ded84ec0835a3ef1">popular Ruby library</a> offering choice between Redis and DragonflyDB as a queueing backend for background jobs 😃.</p>

<p>Developers rewrite systems all the time, but that choice is not always available. Even when allowed, large rewrites often fail to replace existing (stable) systems due to one or the other reason. To optimise our costs, we tried to rewrite parts of the systems that we were sure of. Some infrastructure changes also helped us save cost but that impacted our architecture and also how our team debugs production issues. We tried and did the following:</p>

<ol>
  <li>
    <p>We moved a lot of our applications to Kubernetes cluster. The apps were tested for more than an year on non production environments before moving. Using a combination of AWS on-demand and spot instances clubbed with Kubernetes’ <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">HPA</a>, we were able to save on cloud costs. Spot instances helped us using same infra on a cheaper price, while some on-demand nodes balanced out for stability. HPA allowed us to turn off pods when load on the system was less (eg. at night).</p>
  </li>
  <li>
    <p>We planned, tested and moved our ruby application server from a single threaded (<a href="https://github.com/phusion/passenger">passenger</a>) to multi-threaded (<a href="https://github.com/puma/puma">puma</a>). We had to validate thread safety of our code and third party libraries before doing this.</p>
  </li>
  <li>
    <p>We refactored our <a href="https://github.com/sidekiq/sidekiq">background job server</a> setup to lesser number of queues that simplified our deployment one EC2 and eventually on k8s. This also helped in saving cost as pods were getting utilised to their maximum extent and HPA scaling pods up and down as needed.</p>
  </li>
  <li>
    <p>Other optimisations included rewriting a few systems, details of which cannot be shared (and also won’t be helpful to anyone). These were mostly long term optimisations.</p>
  </li>
</ol>

<h1 id="conclusion">Conclusion</h1>

<p>This was by no means a single person’s work. A lot of senior engineers and devops collaborated to plan and execute all these activities but the gains were rewarding and for the long term. These are recurring bills, so saving even $500 a month means saving $6000 annually. After seeing all these optimisations, I often think - <em>were we really wasting this much money per month</em> 🤔? The answer for this might depend on the team/company. In a growing team, such scenarios often happen. New teams, new projects, new deployments can lead to some inefficiencies over time. Regular consolidations and some approval flow from centralised teams can help in reducing this. For teams that have dedicated people for optimising costs and ensuring efficient use of resources, these instances should be minimum. If you’re a team that has not yet focussed on optimising such costs, do try a few things mentioned here.</p>

<h1 id="bonus">Bonus</h1>

<ol>
  <li>
    <p><strong>Budget alerts</strong> - Many platforms allow setting alerts on user defined thresholds (<a href="https://docs.github.com/en/billing/managing-billing-for-github-actions/managing-your-spending-limit-for-github-actions">example 1</a>, <a href="https://aws.amazon.com/aws-cost-management/aws-budgets/">example 2</a>). You can set these up to catch anomalies in costs. We have some of these setup that often help us.</p>
  </li>
  <li>
    <p><strong>Dedicated ownership -</strong> Software teams rely on many tools. As the team grows, it’s hard for one person to keep a track of everything. At the same time, keeping a basic check on costs and anomalies doesn’t require a lot of expertise. If you assign some people to dedicatedly monitor some tools, it will not burden anyone and will ensure catching such leaks early.</p>
  </li>
  <li>
    <p><strong>Continuous monitoring</strong> - In the past, we use to ignore a lot of platforms and were optimising only cloud bills. This was our first mistake as other bills were not negligible. Second mistake was to check for optimisations only a month before our reservations expired. Cost optimisation is not an annual activity. We should be continuously monitoring these costs.</p>
  </li>
</ol>

<hr />

<p>Thanks for reading. I hope this would help you to optimise some SaaS cost for your organisation. If you liked this post, do check out the following:</p>

<ol>
  <li>
    <p>Make sure your stack is <a href="https://blog.gagan93.me/cloud-pricing-vendor-lock-ins">not vendor locked-in</a> if you want flexibility of moving out in future (or maybe otherwise also)</p>
  </li>
  <li>
    <p>A detailed post on <a href="https://blog.gagan93.me/optimising-docker-builds">optimising docker build time and build size</a>.</p>
  </li>
  <li>
    <p>Working in a team requires asking for help every now and then. Learn <a href="https://blog.gagan93.me/asking-good-questions">how to ask good questions</a>.</p>
  </li>
</ol>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(https://avatars.githubusercontent.com/u/13852061)">Blog Logo</div>
              <h4>Gagandeep Singh</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2024-03-21 00:00">21 Mar 2024</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Made with ❤️ using <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/blog//feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> RSS feed</span></a>
              <div class="inner">
                <section class="copyright">All content copyright &copy; 2024<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
        
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/blog//assets/images/cover.jpg)">
        Image
      </div>
      <div class="inner">
        <a href=/blog// class="btn">Back to All Posts</a>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/blog//assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/blog//assets/js/index.js"></script>
<script type="text/javascript" src="/blog//assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image, .post-image-image2');
    
      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 0.5-Math.max(top/1400, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

  </body>
</html>
